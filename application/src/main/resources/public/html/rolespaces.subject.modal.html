<div class="modal fade bs-modal-lg" id="rolesModal" tabindex="-1" role="dialog" aria-labelledby="serviceperm" aria-hidden="true">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header bg-primary text-white">
        <h3 class="modal-title" id="modal-title">Change space roles <span ng-if="!roles.withSubject">: {{roles.subject}}</span></h3>
      </div>
      <div class="modal-body" id="modal-body">
        <form novalidate name="rolesForm" class="was-validated">
          <div class="row" ng-if="roles.withSubject">
		          <div class="form-group col mb-0" >
		              <label for="username">Subject*</label>
		              <input type="text" required name="subject" class="form-control form-control-sm" id="subject" ng-model="roles.subject">
		               <div  ng-if="rolesForm.subject.$invalid"  class="invalid-feedback">Valid subject required</div><br>
		          </div>
		          <div class="form-group col mb-0">
		              <label for="username">Child space{{(!currentSpaceRole.context && !currentSpaceRole.space) ? '*' : ''}}</label>
		              <input ng-required="!currentSpaceRole.context && !currentSpaceRole.space" type="text" name="space" class="form-control form-control-sm" id="space" ng-model="roles.space">
                   <div  ng-if="rolesForm.space.$invalid"  class="invalid-feedback">Valid child space required</div><br>
		          </div>
           </div>
        </form> 
 
				 <fieldset class="form-group mb-3">
				  <div class="form-check">
				    <input class="form-check-input" id="r_owner" type="checkbox" ng-model="roles.system_map['ROLE_PROVIDER']" >
				    <label for="r_owner">Space Owner</label>
				  </div>
				</fieldset>
				
				<div class="row "> 
				  <div class="form-group col col-md-10">
				      <label for="domain">Custom roles</label>
				      <input type="text" class="form-control form-control-sm" id="domain" ng-model="roles.custom">
				  </div>
				  <div class="col text-right">
				    <button type="button" class="btn btn-primary" ng-click="addRole()" ng-disabled="invalidRole(roles.custom)">Add</button>
				  </div>  
				</div>
				<fieldset class="form-group mb-2">
				  <div class="form-check" ng-repeat="(r,checked) in roles.map">
				    <input class="form-check-input" ng-attr-id="{{'r_' + r}}" type="checkbox" ng-model="roles.map[r]" >
				    <label class="form-check-label" ng-attr-for="{{'r_' + r}}">{{r}}</label>
				  </div>
				</fieldset>
      </div>
      <div class="modal-footer">
        <button class="btn btn-default" type="button" data-dismiss="modal">Cancel</button>
        <button class="btn btn-primary" type="button" ng-click="updateRoles()" ng-disabled="rolesForm.$invalid || !hasRoles(roles.map, roles.system_map)">Save</button>
      </div>
    </div>
  </div>        
</div>  
create table if not exists attribute_entities (id int8 not null, description varchar(255), attr_key varchar(128) not null, is_multiple boolean, name varchar(255), attribute_set varchar(128) not null, attr_type varchar(32) not null, constraint UKd7oy94asbow3iuloyq66fh75b unique (attribute_set, attr_key), primary key (id));
create table if not exists attribute_providers (provider_id varchar(128) not null, set_ids varchar(255), authority varchar(128) not null, configuration_map oid, description_map oid, enabled boolean not null, event_level varchar(32), name varchar(128) not null, persistence_level varchar(32), realm varchar(128) not null, title_map oid, version int4, primary key (provider_id));
create table if not exists attribute_sets (id int8 not null, description varchar(255), identifier varchar(128) not null, name varchar(255), realm varchar(128), constraint UKpdygwg2hk8q9gnlgxaxw36guc unique (identifier), primary key (id));
create table if not exists authorities (id int8 not null, realm varchar(128), role varchar(128) not null, subject_id varchar(128) not null, constraint UKbwk0td085fh20x5acrpt8yfyd unique (subject_id, realm, role), primary key (id));
create table if not exists clients (client_id varchar(128) not null, created_date timestamp, description varchar(255), hook_functions oid, hook_uniquespaces varchar(255), hook_weburls oid, last_modified_date timestamp, name varchar(255), providers varchar(255), realm varchar(128) not null, resource_ids oid, scopes oid, client_type varchar(32), primary key (client_id));
create table if not exists group_members (id int8 not null, group_key varchar(128) not null, realm varchar(128) not null, subject_id varchar(128) not null, constraint UKrsfidprqmkobge5u5civn5sxj unique (subject_id, realm, group_key), primary key (id));
create table if not exists groups (uuid varchar(128) not null, created_date timestamp, description varchar(255), group_key varchar(128) not null, last_modified_date timestamp, name varchar(255), parent_group varchar(128), realm varchar(128) not null, constraint UK7gpb84ynmbu3g2g79tpqjsme0 unique (realm, group_key), constraint UK_25cg20l7ct3xi2isxe3t7llgy unique (group_key), primary key (uuid));
create sequence if not exists hibernate_sequence start 1 increment 1;
create table if not exists identity_providers (provider_id varchar(128) not null, authority varchar(128) not null, configuration_map oid, description_map oid, enabled boolean not null, event_level varchar(32), hook_functions oid, linkable boolean not null, name varchar(128) not null, persistence_level varchar(32), position int4, realm varchar(128) not null, title_map oid, version int4, primary key (provider_id));
create table if not exists internal_attributes (id int8 not null, attr_key varchar(128), provider varchar(128) not null, attribute_set varchar(128) not null, subject_id varchar(128) not null, attr_type varchar(32), attr_value oid, constraint UKid0l4gqd0ifobfx75v1doxen3 unique (provider, subject_id, attribute_set, attr_key),primary key (id));
create table if not exists internal_users (repository_id varchar(128) not null, username varchar(128) not null, confirmation_deadline timestamp, confirmation_key varchar(255), confirmed boolean not null, created_date timestamp, email varchar(255), lang varchar(32), last_modified_date timestamp, name varchar(255), realm varchar(128), status varchar(16), surname varchar(255), user_id varchar(128) not null, uuid varchar(128), constraint UK_5x60sbav1qmd9h7igegmnn1ex unique (confirmation_key), constraint UK_rsj705eb61ypc91a9o51w9nsi unique (uuid), primary key (repository_id, username));
create table if not exists internal_users_passlinks (id int8 not null, created_date timestamp, expiration_date timestamp, passcode varchar(255), provider_id varchar(128), status varchar(255), username varchar(128), primary key (id));
create table if not exists internal_users_passwords (id varchar(128) not null, change_first_access boolean, created_date timestamp, expiration_date timestamp, password varchar(512), realm varchar(128), repository_id varchar(128), reset_deadline timestamp, reset_key varchar(255), status varchar(32), user_id varchar(128) not null, username varchar(128), constraint UKl8jsf3hwbfs8tcy98nmsm6kfa unique (repository_id, reset_key), primary key (id));
create table if not exists internal_users_webauthn_credentials (id varchar(128) not null, attestation_object oid, client_data oid, created_date timestamp, credential_id varchar(128), discoverable boolean, display_name varchar(255), last_used_date timestamp, public_key_cose oid, realm varchar(128), repository_id varchar(128), signature_count int8, status varchar(32), transports varchar(255), user_handle varchar(255), user_id varchar(128) not null, username varchar(128), constraint UK6pkp8b02piytitye8r1isursb unique (repository_id, user_handle, credential_id), constraint UKe98wskmohjji8ywuwkrnt4j66 unique (repository_id, username, user_handle), primary key (id));
create table if not exists oauth2_clients (id int8 not null, access_token_validity int4, additional_configuration oid, additional_information oid, application_type varchar(64), authentication_methods varchar(255), grant_types varchar(255), client_id varchar(128), client_secret varchar(255), first_party boolean, id_token_claims boolean, id_token_validity int4, jwks oid, jwks_uri varchar(255), redirect_uris oid, refresh_token_validity int4, resource_ids varchar(255), subject_type varchar(64), token_type varchar(64), constraint UK_prisbq8a2ut7eg0njlyh4heu5 unique (client_id), primary key (id));
create table if not exists oidc_users (repository_id varchar(128) not null, subject varchar(128) not null, attributes oid, created_date timestamp, email varchar(255), email_verified boolean, family_name varchar(255), given_name varchar(255), issuer varchar(255), lang varchar(32), last_modified_date timestamp, name varchar(255), picture_uri varchar(255), realm varchar(128), status varchar(32), user_id varchar(128) not null, username varchar(128), uuid varchar(128), constraint UK_p4w3x8ottkgeqg15tyiwur1lo unique (uuid), primary key (repository_id, subject));
create table if not exists realm_roles (role_id varchar(128) not null, description varchar(255), name varchar(255), realm varchar(128) not null, role varchar(128) not null, constraint UKjiaxcyptt0s8xt39s7i5559d unique (realm, role), primary key (role_id));
create table if not exists realms (slug varchar(128) not null, created_date timestamp, is_editable boolean, is_public boolean, last_modified_date timestamp, name varchar(255) not null, oauth_configuration_map oid, tos_configuration_map oid, primary key (slug));
create table if not exists resources (id varchar(128) not null, authority varchar(128) not null, provider_id varchar(128) not null, resource_id varchar(128) not null, type varchar(128) not null, constraint UKt7i9but74j1vilgwqqbd17gy9 unique (type, authority, provider_id, resource_id), primary key (id));
create table if not exists saml_users (repository_id varchar(128) not null, subject varchar(128) not null, attributes oid, created_date timestamp, email varchar(255), email_verified boolean, issuer varchar(255), lang varchar(32), last_modified_date timestamp, name varchar(255), realm varchar(128), status varchar(32), surname varchar(255), user_id varchar(128) not null, username varchar(128), uuid varchar(128), constraint UK_lv0gf8wcv6qt4sv6cn8xem1un unique (uuid), primary key (repository_id, subject));
create table if not exists service_claim (claim_id int8 not null, description varchar(255), claim_key varchar(128), claim_multiple boolean, name varchar(255), service_id varchar(128) not null, claim_type varchar(32), constraint UK28da8rfegkgmqmi26y0wojui5 unique (service_id, claim_key), primary key (claim_id));
create table if not exists service_model (service_id varchar(128) not null, claim_mapping oid, description varchar(255), name varchar(255), namespace varchar(255) not null, realm varchar(128) not null, constraint UK_pnib65jl6hubgvjvu35l3ggbc unique (namespace), primary key (service_id));
create table if not exists service_scope (scope varchar(128) not null, approval_any boolean, approval_function oid, approval_manual boolean, approval_roles oid, approval_space_roles oid, claims oid, description varchar(255), name varchar(255), service_id varchar(128) not null, scope_type varchar(32), primary key (scope));
create table if not exists space_roles (id int8 not null, context varchar(255), role varchar(128) not null, space varchar(128) not null, subject_id varchar(128) not null, constraint UKtfqncqbmjx0v6jyvmr2dqk6cj unique (subject_id, context, space, role), primary key (id));
create table if not exists subject_roles (id int8 not null, realm varchar(128), role varchar(128) not null, subject_id varchar(128) not null, constraint UKadvahde3n2wm31x51svknv3l9 unique (subject_id, realm, role), primary key (id));
create table if not exists subjects (subject_id varchar(128) not null, name varchar(255), realm varchar(128) not null, type varchar(32), primary key (subject_id));
create table if not exists template_providers (provider_id varchar(128) not null, authority varchar(128) not null, configuration_map oid, custom_style oid, description_map oid, enabled boolean not null, languages varchar(255), name varchar(128) not null, realm varchar(128) not null, title_map oid, version int4, primary key (provider_id));
create table if not exists templates (id varchar(128) not null, authority varchar(128), content oid, language varchar(255), realm varchar(128), template varchar(128), constraint UK7px59xf543tte24g9shjekk9q unique (authority, realm, template, language), primary key (id));
create table if not exists users (uuid varchar(128) not null, created_date timestamp, email_address varchar(128), email_verified boolean, expiration_date timestamp, last_login_date timestamp, last_login_ip varchar(255), last_login_provider varchar(255), last_modified_date timestamp, realm varchar(128) not null, status varchar(255), tos_accepted boolean, username varchar(128), primary key (uuid));

CREATE TABLE IF NOT EXISTS oauth_refresh_token ( token_id VARCHAR(64) NOT NULL PRIMARY KEY, token bytea NOT NULL, authentication bytea NOT NULL);
CREATE TABLE IF NOT EXISTS oauth_access_token (token_id VARCHAR(256),  token bytea, authentication_id VARCHAR(256), user_name VARCHAR(256), client_id VARCHAR(256), authentication bytea, refresh_token VARCHAR(256));
CREATE TABLE IF NOT EXISTS oauth_approvals (clientId varchar(255) DEFAULT NULL, expiresAt timestamp DEFAULT NULL, lastModifiedAt timestamp DEFAULT NULL, scope varchar(255) DEFAULT NULL, status varchar(255) DEFAULT NULL, userId varchar(255) DEFAULT NULL);
CREATE TABLE IF NOT EXISTS attributes (entity_id VARCHAR(256), provider_id VARCHAR(256), attr_key VARCHAR(256), attr_value bytea);
CREATE TABLE IF NOT EXISTS audit (time TIMESTAMP, principal varchar(255), realm varchar(255) DEFAULT NULL, type varchar(255), event bytea );
CREATE TABLE IF NOT EXISTS oauth_code (code VARCHAR(256), client_id VARCHAR(256), expiresAt TIMESTAMP, authentication bytea);
CREATE TABLE IF NOT EXISTS provider_config (type VARCHAR(256), provider_id VARCHAR(256),  realm VARCHAR(256), config bytea, PRIMARY KEY (provider_id, type));